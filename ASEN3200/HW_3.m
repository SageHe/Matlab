%Question 4 1-3-1 rotation
R3_3 = [cosd(150) sind(150) 0;-sind(150) cosd(150) 0;0 0 1];
R_1 = [1 0 0;0 cosd(-60) sind(-60);0 -sind(-60) cosd(-60)];
R3_1 = [cosd(30) sind(30) 0;-sind(30) cosd(30) 0;0 0 1];

Q = R3_3*R_1*R3_1;

K = [(Q(1,1) - Q(2,2) - Q(3,3)) (Q(2,1) + Q(1,2)) (Q(3,1) + Q(1,3)) (Q(2,3) - Q(3,2));...
    (Q(2,1) + Q(1,2)) (-Q(1,1) + Q(2,2) - Q(3,3)) (Q(3,2) + Q(2,3)) (Q(3,1) - Q(1,3));... 
    (Q(3,1) + Q(1,3)) (Q(3,2) + Q(2,3)) (-Q(1,1) - Q(2,2) + Q(3,3)) (Q(1,2) - Q(2,1));...
    (Q(2,3) - Q(3,2)) (Q(3,1) - Q(1,3)) (Q(1,2) - Q(2,1)) (Q(1,1) + Q(2,2) + Q(3,3))]*(1/3);

[V D] = eig(K);

rot_axis = V(:,3);

%3-2-1 rotation
R3 = [cosd(30) sind(30) 0;-sind(30) cosd(30) 0;0 0 1];
R2 = [cosd(-60) 0 -sind(-60);0 1 0;sind(-60) 0 cosd(-60)];
R1 = [1 0 0;0 cosd(150) sind(150);0 -sind(150) cosd(150)];

Q = R1*R2*R3;

K = [(Q(1,1) - Q(2,2) - Q(3,3)) (Q(2,1) + Q(1,2)) (Q(3,1) + Q(1,3)) (Q(2,3) - Q(3,2));...
    (Q(2,1) + Q(1,2)) (-Q(1,1) + Q(2,2) - Q(3,3)) (Q(3,2) + Q(2,3)) (Q(3,1) - Q(1,3));... 
    (Q(3,1) + Q(1,3)) (Q(3,2) + Q(2,3)) (-Q(1,1) - Q(2,2) + Q(3,3)) (Q(1,2) - Q(2,1));...
    (Q(2,3) - Q(3,2)) (Q(3,1) - Q(1,3)) (Q(1,2) - Q(2,1)) (Q(1,1) + Q(2,2) + Q(3,3))]*(1/3);

[V D] = eig(K);

